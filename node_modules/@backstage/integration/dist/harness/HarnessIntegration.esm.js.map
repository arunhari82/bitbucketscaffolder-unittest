{"version":3,"file":"HarnessIntegration.esm.js","sources":["../../src/harness/HarnessIntegration.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { basicIntegrations, defaultScmResolveUrl } from '../helpers';\nimport { ScmIntegration, ScmIntegrationsFactory } from '../types';\nimport { HarnessIntegrationConfig, readHarnessConfig } from './config';\nimport { getHarnessEditContentsUrl } from './core';\n\n/**\n * A Harness Code based integration.\n *\n * @public\n */\nexport class HarnessIntegration implements ScmIntegration {\n  static factory: ScmIntegrationsFactory<HarnessIntegration> = ({ config }) => {\n    const configs = config.getOptionalConfigArray('integrations.harness') ?? [];\n    const harnessConfigs = configs.map(c => readHarnessConfig(c));\n\n    return basicIntegrations(\n      harnessConfigs.map(c => new HarnessIntegration(c)),\n      (harness: HarnessIntegration) => harness.config.host,\n    );\n  };\n\n  constructor(readonly config: HarnessIntegrationConfig) {}\n\n  get type(): string {\n    return 'harness';\n  }\n\n  get title(): string {\n    return this.config.host;\n  }\n\n  resolveUrl(options: {\n    url: string;\n    base: string;\n    lineNumber?: number | undefined;\n  }): string {\n    return defaultScmResolveUrl(options);\n  }\n\n  resolveEditUrl(url: string): string {\n    return getHarnessEditContentsUrl(this.config, url);\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAyBO,MAAM,mBAAA,GAAN,MAAM,mBAA6C,CAAA;AAAA,EAWxD,YAAqB,MAAkC,EAAA;AAAlC,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA,CAAA;AAAA,GAAmC;AAAA,EAExD,IAAI,IAAe,GAAA;AACjB,IAAO,OAAA,SAAA,CAAA;AAAA,GACT;AAAA,EAEA,IAAI,KAAgB,GAAA;AAClB,IAAA,OAAO,KAAK,MAAO,CAAA,IAAA,CAAA;AAAA,GACrB;AAAA,EAEA,WAAW,OAIA,EAAA;AACT,IAAA,OAAO,qBAAqB,OAAO,CAAA,CAAA;AAAA,GACrC;AAAA,EAEA,eAAe,GAAqB,EAAA;AAClC,IAAO,OAAA,yBAAA,CAA0B,IAAK,CAAA,MAAA,EAAQ,GAAG,CAAA,CAAA;AAAA,GACnD;AACF,CAAA,CAAA;AA/BE,aAAA,CADW,mBACJ,EAAA,SAAA,EAAsD,CAAC,EAAE,QAAa,KAAA;AA1B/E,EAAA,IAAA,EAAA,CAAA;AA2BI,EAAA,MAAM,WAAU,EAAO,GAAA,MAAA,CAAA,sBAAA,CAAuB,sBAAsB,CAAA,KAApD,YAAyD,EAAC,CAAA;AAC1E,EAAA,MAAM,iBAAiB,OAAQ,CAAA,GAAA,CAAI,CAAK,CAAA,KAAA,iBAAA,CAAkB,CAAC,CAAC,CAAA,CAAA;AAE5D,EAAO,OAAA,iBAAA;AAAA,IACL,eAAe,GAAI,CAAA,CAAA,CAAA,KAAK,IAAI,mBAAA,CAAmB,CAAC,CAAC,CAAA;AAAA,IACjD,CAAC,OAAgC,KAAA,OAAA,CAAQ,MAAO,CAAA,IAAA;AAAA,GAClD,CAAA;AACF,CAAA,CAAA,CAAA;AATK,IAAM,kBAAN,GAAA;;;;"}