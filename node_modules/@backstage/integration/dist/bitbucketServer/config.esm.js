import { trimEnd } from 'lodash';
import { isValidHost } from '../helpers.esm.js';

function readBitbucketServerIntegrationConfig(config) {
  var _a;
  const host = config.getString("host");
  let apiBaseUrl = config.getOptionalString("apiBaseUrl");
  const token = (_a = config.getOptionalString("token")) == null ? void 0 : _a.trim();
  const username = config.getOptionalString("username");
  const password = config.getOptionalString("password");
  if (!isValidHost(host)) {
    throw new Error(
      `Invalid Bitbucket Server integration config, '${host}' is not a valid host`
    );
  }
  if (apiBaseUrl) {
    apiBaseUrl = trimEnd(apiBaseUrl, "/");
  } else {
    apiBaseUrl = `https://${host}/rest/api/1.0`;
  }
  return {
    host,
    apiBaseUrl,
    token,
    username,
    password
  };
}
function readBitbucketServerIntegrationConfigs(configs) {
  return configs.map(readBitbucketServerIntegrationConfig);
}

export { readBitbucketServerIntegrationConfig, readBitbucketServerIntegrationConfigs };
//# sourceMappingURL=config.esm.js.map
